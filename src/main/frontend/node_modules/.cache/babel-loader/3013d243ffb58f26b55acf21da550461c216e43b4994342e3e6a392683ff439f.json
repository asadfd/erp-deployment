{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ApprovalPending=()=>{const[pendingRequests,setPendingRequests]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[showRejectModal,setShowRejectModal]=useState(false);const[selectedRequest,setSelectedRequest]=useState(null);const[rejectionReason,setRejectionReason]=useState('');useEffect(()=>{fetchPendingRequests();},[]);const fetchPendingRequests=async()=>{try{setLoading(true);const response=await axios.get('/api/employee-requests/pending',{withCredentials:true});setPendingRequests(response.data);setError('');}catch(err){setError('Failed to fetch pending requests');console.error('Error fetching pending requests:',err);}finally{setLoading(false);}};const handleApprove=async requestId=>{if(window.confirm('Are you sure you want to approve this employee request?')){try{await axios.post(\"/api/employee-requests/approve/\".concat(requestId),{},{withCredentials:true});alert('Employee request approved successfully');fetchPendingRequests();}catch(err){var _err$response,_err$response$data;alert('Failed to approve request: '+(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||err.message));}}};const handleRejectClick=request=>{setSelectedRequest(request);setShowRejectModal(true);setRejectionReason('');};const handleReject=async()=>{if(!rejectionReason.trim()){alert('Please provide a rejection reason');return;}try{await axios.post(\"/api/employee-requests/reject/\".concat(selectedRequest.id),{reason:rejectionReason},{withCredentials:true});alert('Employee request rejected');setShowRejectModal(false);fetchPendingRequests();}catch(err){var _err$response2,_err$response2$data;alert('Failed to reject request: '+(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.error)||err.message));}};if(loading)return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});if(error)return/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error});return/*#__PURE__*/_jsxs(\"div\",{className:\"approval-pending\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Pending Employee Requests\"}),pendingRequests.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No pending requests\"}):/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Employee ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Passport ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Emirates ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Phone\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Joining Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Salary\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Requested By\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:pendingRequests.map(request=>{var _request$requestedBy;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:request.name}),/*#__PURE__*/_jsx(\"td\",{children:request.empId}),/*#__PURE__*/_jsx(\"td\",{children:request.passportId}),/*#__PURE__*/_jsx(\"td\",{children:request.emiratesId}),/*#__PURE__*/_jsx(\"td\",{children:request.phoneNumber}),/*#__PURE__*/_jsx(\"td\",{children:new Date(request.joiningDate).toLocaleDateString()}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",request.salary]}),/*#__PURE__*/_jsx(\"td\",{children:(_request$requestedBy=request.requestedBy)===null||_request$requestedBy===void 0?void 0:_request$requestedBy.username}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-approve\",onClick:()=>handleApprove(request.id),children:\"Approve\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-reject\",onClick:()=>handleRejectClick(request),children:\"Reject\"})]})]},request.id);})})]})}),showRejectModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Reject Employee Request\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Employee: \",selectedRequest===null||selectedRequest===void 0?void 0:selectedRequest.name]}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Enter rejection reason...\",value:rejectionReason,onChange:e=>setRejectionReason(e.target.value),rows:\"4\",style:{width:'100%'}}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",onClick:()=>setShowRejectModal(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:handleReject,children:\"Reject Request\"})]})]})})]});};export default ApprovalPending;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","ApprovalPending","pendingRequests","setPendingRequests","loading","setLoading","error","setError","showRejectModal","setShowRejectModal","selectedRequest","setSelectedRequest","rejectionReason","setRejectionReason","fetchPendingRequests","response","get","withCredentials","data","err","console","handleApprove","requestId","window","confirm","post","concat","alert","_err$response","_err$response$data","message","handleRejectClick","request","handleReject","trim","id","reason","_err$response2","_err$response2$data","children","className","length","map","_request$requestedBy","name","empId","passportId","emiratesId","phoneNumber","Date","joiningDate","toLocaleDateString","salary","requestedBy","username","onClick","placeholder","value","onChange","e","target","rows","style","width"],"sources":["/mnt/c/Users/Asad Dimtimkar/IdeaProjects/ERPcustom/src/main/frontend/src/components/ApprovalPending.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nconst ApprovalPending = () => {\n  const [pendingRequests, setPendingRequests] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [showRejectModal, setShowRejectModal] = useState(false);\n  const [selectedRequest, setSelectedRequest] = useState(null);\n  const [rejectionReason, setRejectionReason] = useState('');\n\n  useEffect(() => {\n    fetchPendingRequests();\n  }, []);\n\n  const fetchPendingRequests = async () => {\n    try {\n      setLoading(true);\n      const response = await axios.get('/api/employee-requests/pending', {\n        withCredentials: true\n      });\n      setPendingRequests(response.data);\n      setError('');\n    } catch (err) {\n      setError('Failed to fetch pending requests');\n      console.error('Error fetching pending requests:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleApprove = async (requestId) => {\n    if (window.confirm('Are you sure you want to approve this employee request?')) {\n      try {\n        await axios.post(`/api/employee-requests/approve/${requestId}`, {}, {\n          withCredentials: true\n        });\n        alert('Employee request approved successfully');\n        fetchPendingRequests();\n      } catch (err) {\n        alert('Failed to approve request: ' + (err.response?.data?.error || err.message));\n      }\n    }\n  };\n\n  const handleRejectClick = (request) => {\n    setSelectedRequest(request);\n    setShowRejectModal(true);\n    setRejectionReason('');\n  };\n\n  const handleReject = async () => {\n    if (!rejectionReason.trim()) {\n      alert('Please provide a rejection reason');\n      return;\n    }\n\n    try {\n      await axios.post(`/api/employee-requests/reject/${selectedRequest.id}`, {\n        reason: rejectionReason\n      }, {\n        withCredentials: true\n      });\n      alert('Employee request rejected');\n      setShowRejectModal(false);\n      fetchPendingRequests();\n    } catch (err) {\n      alert('Failed to reject request: ' + (err.response?.data?.error || err.message));\n    }\n  };\n\n  if (loading) return <div>Loading...</div>;\n  if (error) return <div className=\"error-message\">{error}</div>;\n\n  return (\n    <div className=\"approval-pending\">\n      <h2>Pending Employee Requests</h2>\n      \n      {pendingRequests.length === 0 ? (\n        <p>No pending requests</p>\n      ) : (\n        <div className=\"table-container\">\n          <table className=\"data-table\">\n            <thead>\n              <tr>\n                <th>Name</th>\n                <th>Employee ID</th>\n                <th>Passport ID</th>\n                <th>Emirates ID</th>\n                <th>Phone</th>\n                <th>Joining Date</th>\n                <th>Salary</th>\n                <th>Requested By</th>\n                <th>Actions</th>\n              </tr>\n            </thead>\n            <tbody>\n              {pendingRequests.map((request) => (\n                <tr key={request.id}>\n                  <td>{request.name}</td>\n                  <td>{request.empId}</td>\n                  <td>{request.passportId}</td>\n                  <td>{request.emiratesId}</td>\n                  <td>{request.phoneNumber}</td>\n                  <td>{new Date(request.joiningDate).toLocaleDateString()}</td>\n                  <td>${request.salary}</td>\n                  <td>{request.requestedBy?.username}</td>\n                  <td>\n                    <button \n                      className=\"btn btn-approve\"\n                      onClick={() => handleApprove(request.id)}\n                    >\n                      Approve\n                    </button>\n                    <button \n                      className=\"btn btn-reject\"\n                      onClick={() => handleRejectClick(request)}\n                    >\n                      Reject\n                    </button>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      )}\n\n      {showRejectModal && (\n        <div className=\"modal\">\n          <div className=\"modal-content\">\n            <h3>Reject Employee Request</h3>\n            <p>Employee: {selectedRequest?.name}</p>\n            <textarea\n              placeholder=\"Enter rejection reason...\"\n              value={rejectionReason}\n              onChange={(e) => setRejectionReason(e.target.value)}\n              rows=\"4\"\n              style={{ width: '100%' }}\n            />\n            <div className=\"modal-actions\">\n              <button className=\"btn btn-secondary\" onClick={() => setShowRejectModal(false)}>\n                Cancel\n              </button>\n              <button className=\"btn btn-danger\" onClick={handleReject}>\n                Reject Request\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ApprovalPending;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}